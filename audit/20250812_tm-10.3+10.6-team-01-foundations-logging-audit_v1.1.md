---
title: "Audit — tm-10.3 + tm-10.6 (Foundations Logging)"
doc_kind: audit
team: team-01
team_name: foundations
version: 1.1
status: reviewed
author: AI-Implementateur
tm_ids: [10.3, 10.6]
scope: logging
related_files:
  - orchestrator/src/app.ts
  - docs/spec/LOGGING_ERRORS_SPEC.md
  - orchestrator/test/contract/logging-redaction.test.ts
  - orchestrator/test/integration/generate-audio-step-logs.test.ts
  - orchestrator/test/contract/chat-llm-metrics.test.ts
---

#TEST: orchestrator/test/contract/logging-redaction.test.ts
#TEST: orchestrator/test/integration/generate-audio-step-logs.test.ts
#TEST: orchestrator/test/contract/chat-llm-metrics.test.ts

## Résumé (v1.1)
- 10.3 (IMPL: logs corrélés + ErrorResponse): conforme.
  - `correlation_id` injecté dans tous les logs applicatifs (`onResponse`), erreurs contractuelles stables.
  - Chat: `RAG_START/COMPLETE` avec `llm_generate_ms` et `match_documents_ms`.
  - Process-document: événements `EXTRACT/EMBED/UPSERT` + `doc.processed` (timings).
  - Audio: `TTS_START/COMPLETE`, `UPLOAD_START/COMPLETE`, `CALLBACK_SENT`.
- 10.6 (IMPL: redaction + sampling): redaction OK, sampling non implémenté (à décider/specifier).

## Vérifications
- Redaction: test dédié vérifie que `Authorization` est `[REDACTED]` dans les logs.
- Audio: test d’intégration couvre événements TTS/UPLOAD (+ callback testé ailleurs).
- Chat: métriques `llm_generate_ms` présentes dans `RAG_COMPLETE`.

## Écarts restants
- Sampling des logs non implémenté (hors périmètre immédiat), à cadrer dans SPEC si requis.

## Limitations
- Logs Fastify par défaut: format JSON lines non uniformisé à 100% (niveau/horodatage gérés par Fastify). Suffisant pour parité fonctionnelle.

## Décision
- Conformité renforcée: redaction testée, événements d’étape présents, métriques ajoutées. Sampling: à définir ultérieurement.
