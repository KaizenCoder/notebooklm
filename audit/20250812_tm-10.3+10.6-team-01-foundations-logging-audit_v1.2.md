---
title: "Audit — tm-10.3 + tm-10.6 (Foundations Logging)"
doc_kind: audit
team: team-01
team_name: foundations
version: 1.2
status: reviewed
author: AI-Implementateur
tm_ids: [10.3, 10.6]
scope: logging
related_files:
  - orchestrator/src/app.ts
  - docs/spec/LOGGING_ERRORS_SPEC.md
  - orchestrator/test/contract/logging-redaction.test.ts
  - orchestrator/test/integration/generate-audio-step-logs.test.ts
  - orchestrator/test/contract/chat-llm-metrics.test.ts
---

#TEST: orchestrator/test/contract/logging-redaction.test.ts
#TEST: orchestrator/test/integration/generate-audio-step-logs.test.ts
#TEST: orchestrator/test/contract/chat-llm-metrics.test.ts

## Exemples de logs (anonymisés)
```json
{"level":30,"correlation_id":"req-1","event_code":"RAG_COMPLETE","route":"/webhook/chat","rag_duration_ms":21,"match_documents_ms":0,"llm_generate_ms":17}
{"level":30,"correlation_id":"req-7","event_code":"TTS_COMPLETE","route":"/webhook/generate-audio","tts_duration_ms":3}
{"level":30,"correlation_id":"req-7","event_code":"UPLOAD_COMPLETE","route":"/webhook/generate-audio","upload_duration_ms":0,"audio_url_host":"mock-storage"}
{"level":30,"correlation_id":"req-9","route":"/webhook/process-document","method":"POST","headers":{"authorization":"[REDACTED]","host":"localhost:80"}}
```

## Résumé (v1.2)
- Événements d’étape complets (chat/process-document/generate-audio) + métriques présentes, redaction vérifiée.
- `correlation_id` injecté dans chaque log applicatif (hook `onResponse`) et propagé aux événements métier.

## Écart restant
- Sampling non implémenté (non bloquant; à cadrer dans SPEC si exigé).
