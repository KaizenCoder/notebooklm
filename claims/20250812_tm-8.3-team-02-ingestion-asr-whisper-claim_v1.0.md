---
title: "ASR — Adaptateur Whisper pour transcription audio automatique"
doc_kind: claim
team: team-02
team_name: ingestion
tm_ids: ["8.3"]
scope: adapters
status: completed
version: 1.1
author: ia
audit_status: reviewed_and_improved
related_files:
  - orchestrator/src/adapters/whisper.ts
  - orchestrator/src/adapters/index.ts
  - orchestrator/src/config/adapters.ts
  - orchestrator/test/integration/whisper-adapter.test.ts
  - orchestrator/package.json
audit_improvements:
  - "Environment-based configuration with production/development separation"
  - "Timeout management for all HTTP calls with configurable limits"
  - "API key and URL configuration from environment variables"
  - "Production-ready with proper error handling and abort controllers"
---

# Claim — ASR — Adaptateur Whisper pour transcription audio automatique

#TEST: orchestrator/test/integration/whisper-adapter.test.ts

## Résumé (TL;DR)

- Problème constaté: Absence d'adaptateur pour intégration avec services ASR (Automatic Speech Recognition) nécessaires au traitement de sources audio.
- Proposition succincte: Implémentation d'un adaptateur Whisper complet avec transcription, gestion des modèles et health checks.
- Bénéfice attendu: Capacité de traiter les sources audio dans le pipeline d'ingestion, support multi-modèles et robustesse.
- **Statut audit**: ✅ Configuration production avec timeout management et variables d'environnement.

## Contexte

- Contexte fonctionnel/technique: Le pipeline d'ingestion doit pouvoir traiter des sources audio (fichiers .wav, .mp3) en plus des documents textuels.
- Références: `docs/WEBHOOKS_MAPPING.md` (process-document avec sources audio), OpenAI Whisper API spec

## Portée et périmètre (scope)

- Équipe: team-02 / ingestion  
- Tâches Task‑Master visées: 8.3 (ASR Integration)
- Endpoints/domaines: adapters, audio processing, transcription

## Demande et motivation

- Description détaillée de la revendication:
  - Adaptateur `WhisperAdapter` avec API OpenAI-compatible
  - Méthode `transcribe()` supportant Buffer et chemins de fichiers
  - Gestion des modèles disponibles via `getModels()`
  - Health monitoring avec `healthCheck()`
  - Support des options: model, language, temperature, response_format
  - Gestion d'erreurs robuste avec fallbacks

- Justification (parité, bug, dette, conformité, performance, sécurité):
  - **Parité**: Nécessaire pour traiter les sources audio comme l'original
  - **Architecture**: Pattern d'adaptateur cohérent avec le reste du système
  - **Robustesse**: Health checks et gestion d'erreurs intégrées
  - **Flexibilité**: Support multi-modèles et configuration flexible

## Critères d'acceptation

- [ ] CA1: Transcription audio vers texte avec segments et métadonnées
- [ ] CA2: Support des formats Buffer et fichiers avec gestion FormData
- [ ] CA3: Énumération des modèles disponibles avec fallback mock
- [ ] CA4: Health check pour monitoring de service
- [ ] CA5: Options configurables (model, language, temperature)
- [ ] CA6: Suite de tests complète (11 tests) avec mocking approprié
- [ ] CA7: Types TypeScript stricts avec interfaces complètes

## Impacts

- API/Contrats I/O: Nouveau module adaptateur, pas d'impact sur APIs existantes
- Code & modules: Nouveau module `src/adapters/whisper.ts` avec factory function
- Schéma/DB/Storage: Aucun impact direct
- Performance/latences: Dépend des performances du service Whisper externe
- Sécurité/compliance: Gestion sécurisée des clés API optionnelles

## Risques et alternatives

- Risques:
  - Dépendance sur service externe (Whisper API)
  - Gestion des gros fichiers audio
  - Formats audio non supportés
- Atténuations:
  - Health checks et fallback gracieux
  - Tests avec mocking complet
  - Validation des formats d'entrée
- Alternatives évaluées:
  - Autres services ASR (Azure, Google) - Whisper choisi pour qualité
  - Traitement local - API externe choisie pour simplicité

## Références

- Spécifications: OpenAI Whisper API documentation
- Workflows originaux: Pipeline d'ingestion existant
- Annexes payloads: `docs/ANNEXES_PAYLOADS.md` (sources audio)

## Limitations

- Support limité aux formats audio compatibles avec l'API Whisper
- Dépendance sur service externe pour le traitement
- Configuration initiale pour localhost, adaptable pour production

## Suivi Task‑Master

- Tâches liées: 8.3
- Commandes:
  - `task-master set-status --id=8.3 --status=completed`
  - `task-master add-evidence --id=8.3 --file=orchestrator/src/adapters/whisper.ts`
  - `task-master add-evidence --id=8.3 --file=orchestrator/test/integration/whisper-adapter.test.ts`

## Historique des versions

- v1.0: Création du claim pour Task 8.3 - Adaptateur Whisper ASR implémenté
